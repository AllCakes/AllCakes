{% load static %}

<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <!--Î∂ÄÌä∏Ïä§Ìä∏Îû© Î∂àÎü¨Ïò® Í≤É-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Allcakes Mypage</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/base.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/main.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static '/css/rating.css'%}">
    <link rel="stylesheet" href="{% static 'css/mypagenew.css' %}" type="text/css">
    <script defer src="/static/js/rating.js"></script>
</head>

<body class="mypage-body">
    <header>
        <nav class="navbar fixed-top navbar-expand-lg navbar-light" style="background-color: white;">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">ALLCAKES</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <!-- Í∞ÄÍ≤å ÏÉÅÏÑ∏Ï†ïÎ≥¥ Îì§Ïñ¥Í∞à Ïàò ÏûàÎèÑÎ°ù ÏûÑÏãúÎ°ú ÎßÅÌÅ¨ Îã¨ÏïÑ ÎëîÍ±∞Í≥† -->
                        <!-- Î¶¨Î∑∞Îäî ÎßàÏù¥ÌéòÏù¥ÏßÄ Ï∞∏Í≥† -->
						<li class="nav-item ">
                            <a class="nav-link px-2" href="{% url 'stores_all' %}">Stores</a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link px-2" href="{% url 'cakes_all' %}">Cakes</a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link px-2" href="#">Reviews</a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link px-2" href="{% url 'search_all' %}">Search</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" id="navcenter" href="#user-info-header">Ï†ïÎ≥¥</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="navcenter" href="#order-info-header">Ï£ºÎ¨∏ÎÇ¥Ïó≠</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="navcenter" href="#review-info-header">ÎÇ¥ Î¶¨Î∑∞</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="navcenter" href="#cake-info-header">Ï∞úÌïú ÏºÄÏù¥ÌÅ¨</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="navcenter" href="#store-info-header">Ï∞úÌïú Í∞ÄÍ≤å</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <!--Î°úÍ∑∏Ïù∏ or Î°úÍ∑∏ÏïÑÏõÉ-->

                        <li class="nav-item">
                            {% if user.is_authenticated %}
                            {% if user.is_kakao == True %}
                            <!-- Ïù∏Ï¶ùÎêú ÏÉÅÌÉúÏóêÏÑú Ïπ¥Ïπ¥Ïò§Ïù∏ Í≤ΩÏö∞, ÏïÑÎãå Í≤ΩÏö∞-->
                            <a class="nav-link px-2" href="{% url 'logout_with_kakao' %}">Logout</a>
                            {% else %}
                            <a class="nav-link px-2" href="{% url 'logout' %}">Logout</a>
                            {% endif %}

                            {% else %}
                            <!-- Ïù∏Ï¶ùÎêòÏßÄ ÏïäÏùÄ ÏÉÅÌÉúÎ©¥ Î°úÍ∑∏Ïù∏(Í∞ÄÏûÖ) ÎßÅÌÅ¨ -->
                            <a class="nav-link px-2" href="{% url 'login_home' %}">Login</a>
                            {% endif %}
                        </li>
                        <!--Î°úÍ∑∏Ïù∏Í≥º Î°úÍ∑∏ÏïÑÏõÉÎßå Îú∏ -->

                        <!--ÎßàÏù¥ÌéòÏù¥ÏßÄ or about us-->
                        <li class="nav-item">

                            {% if user.is_authenticated %}
                            <!-- Ïú†Ï†ÄÍ∞Ä Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÏù¥Î©¥ ÏÉÅÎã®Ïóê Îú®Í≥† ÌÅ¥Î¶≠ Ïãú Ïú†Ï†Ä pkÏ†ÑÎã¨ -->
                            <a class="nav-link px-2" href="{% url 'mypage' user_pk=user.pk %}">My Page</a>
                            {% endif %}

                            {% if not user.is_authenticated %}
                            <a class="nav-link px-2" href="#">About Us</a>
                        {% endif %}
                            <!--‚úÖÏûÑÏãúÎ°ú ÎÑ£Ïùå! ÎßÅÌÅ¨Îäî Ïó∞Í≤∞ Ïïà ÌñàÏùå, Îì§Ïñ¥Í∞à ÌéòÏù¥ÏßÄ ÏÉùÍ∞ÅÌï¥Î¥êÏïºÌï®-->

                        <!--ÏúÑÏπò Í≤ÄÏÉâ ÌïÑÌÑ∞Ïö© Í≤ÄÏÉâÏ∞Ω => Ïñ¥ÎîîÏóê Î∞∞ÏπòÌï† ÏßÄ ÏùòÎÖº ÌïÑÏöî!-->
                        </li>
                        <!--
                        <li class="nav-item">
                        Í≤ÄÏÉâ Í∞ÄÍπåÏö¥ÏàúÏ†ïÎ†¨ ÏÇ≠Ï†ú
                            <form action="{% url 'search' %}" method="GET" class="d-flex">
                                Ïù¥Ïú†Îäî Î™®Î•¥Í≤†ÎäîÎç∞ headÏóê styleÌÉúÍ∑∏ ÎÑ£Ïñ¥ÏÑú Í≤ÄÏÉâÎ∞î ÌÅ¨Í∏∞ Ï°∞Ï†àÌïòÎ©¥ Ï†ÅÏö©Ïù¥ ÏïàÎêòÏñ¥ÏÑú input ÌÉúÍ∑∏Ïóê Ïä§ÌÉÄÏùº ÏßëÏñ¥ÎÑ£Ïùå
                                <input class="form-control me-2" type="text" placeholder="Search" aria-label="Search" name="q"
                                    style="width: 200px; height: 30px; margin-top: 5px; font-family: 'SF_HambakSnow'; border-radius: 0%; border-color: black;">
                                <button class="btn btn-secondary btn-sm" type="submit" value="r">üîç</button>
                            </form>
                        </li>   
					</ul>
                -->


                    

                </div>
            </div>
        </nav>
    </header>

<!-- Ï†ÑÎã¨Îêú Í∞íÏùÄ user_pkÍ∞í(user_pk), ÏµúÍ∑º Î¶¨Î∑∞ 4Í∞ú(reviews), ÏßÑÌñâ Ï£ºÎ¨∏Ï†ïÎ≥¥ Î™®Îëê(orders), ÏºÄÏù¥ÌÅ¨ Ï∞ú4Í∞ú(liked_cakes), Í∞ÄÍ≤å Ï∞ú 4Í∞ú(liked_stores) -->
<!-- Î°úÍ∑∏Ïù∏Îêú Ïú†Ï†ÄÏôÄ urlÏÜç pkÍ∞Ä Îã§Î•¥Î©¥ Ï†ëÍ∑ºÌïòÏßÄ Î™ªÌïòÍ≤å -->
{% if user.pk != user_pk %}
    <h1> ÏûòÎ™ªÎêú Ï†ëÍ∑ºÏûÖÎãàÎã§ (Allcakes)</h1>

{% else %}
<!-- Î™®Îì† Ï†ïÎ≥¥Í∞Ä Îì§Ïñ¥Í∞ÄÎäî Í≥≥ O -->
    <div class = "body3">
        <div class="user-info">
            <h2 id="user-info-header"> Í≥†Í∞ù Ï†ïÎ≥¥ </h2>
            <img src="{% static 'img/allcake_whitecake.png' %}">
            <div class="users-detail">
                <!-- ÏùºÎ∞ò Î°úÍ∑∏Ïù∏ Ïãú email Ï†ïÎ≥¥, ÎãâÎÑ§ÏûÑ Ï†ïÎ≥¥Í∞Ä ÏûàÍ≥† 
                Ïπ¥Ïπ¥Ïò§ Î°úÍ∑∏Ïù∏ Ïãú email, ÎãâÎÑ§ÏûÑ, ÏÑ†ÌÉùÏ†ÅÏúºÎ°ú ÏÉùÏùº, ÏÑ±Î≥Ñ, Ïó∞Î†πÎåÄÍ∞Ä ÏûàÏùå 
                ÎÇ®ÏûêÏù∏ÏßÄ, ÎÇ¥ ÏÉùÏùºÏù¥ Ïñ∏Ï†úÏù∏ÏßÄ, Ïó∞Î†πÎåÄÎäî Ïñ¥ÎîîÏù∏ÏßÄÎäî Ïú†Ï†ÄÏóêÍ≤å Î≥¥Í≥† Ïã∂ÏùÄ Ï†ïÎ≥¥Í∞Ä ÏïÑÎãò. 
                ÎãâÎÑ§ÏûÑÎßå Î≥¥Ïó¨Ï£ºÍ≥† Ï†ïÎ≥¥ ÏàòÏ†ï ÎàåÎ†ÄÏùÑ Îïå ÎãâÎÑ§ÏûÑÎßå ÏàòÏ†ïÌïòÎèÑÎ°ù ÌïòÍ∏∞. (ÎÇòÎ®∏ÏßÄÎäî Ïπ¥Ïπ¥Ïò§ ÎèôÏùò Ï≤†ÌöåÎ°ú Íµ¨ÌòÑ)  -->
            </div>
            <div class="user-info-text">
                <div class="user-nickname">
                    <p>ÎãâÎÑ§ÏûÑ: {{user.nickname}}</p>
                </div>
                <a href="{% url 'view_coupon' user_pk=user.pk %}"><button>Ïø†Ìè∞Ìï®</button></a>
                <a href="{% url 'edit_nickname' %}" id="edit"><button>ÏàòÏ†ï</button></a>
                <a href="{% url 'delete_user' user_pk=user.pk %}" id="delete"><button>ÌÉàÌá¥</button></a>
            </div>
        </div>
        <!-- Ï£ºÎ¨∏ ÎÇ¥Ïó≠Ïù¥ Î¶¨Î∑∞ Í¥ÄÎ¶¨Î≥¥Îã§ Î®ºÏ†Ä ÎÇòÏôÄÏïº Ìé∏ÌïòÏßÄ ÏïäÏùÑÍπå? -->
        <!-- Ï£ºÎ¨∏ ÎÇ¥Ïó≠ Í¥ÄÎ¶¨Î•º ÎßàÏù¥ÌéòÏù¥ÏßÄÏóêÏÑú Ìï† Í±∞Î©¥ -->
        <!-- ÎßàÏù¥ÌéòÏù¥ÏßÄÏóêÏÑú Ï£ºÎ¨∏ÏùÑ Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÎã§Í≥† Ï£ºÎ¨∏ ÎÅùÎÇòÍ≥† ÏïåÎ†§Ï£ºÍ∏∞ÎùºÎèÑ Ìï¥Ïïº Îê† ÎìØ Ìï®. -->
        <div class="user-order">
            <h2 id="order-info-header"> Ï£ºÎ¨∏ ÎÇ¥Ïó≠ </h2>
            <div class="order-info">
                <table style="width:100%">
                    <tr>
                        <th>Ï£ºÎ¨∏ Î≤àÌò∏</th>
                        <th>ÏºÄÏù¥ÌÅ¨ ÏÇ¨ÏßÑ</th>
                        <th>Í∞ÄÍ≤å Ïù¥Î¶Ñ</th>
                        <th>ÏßÑÌñâ ÏÉÅÌÉú</th> <!--ÏßÑÌñâÏÉÅÌÉú ÏòàÏãú: Í≤∞Ï†úÏôÑÎ£å(is_paid=True), Ï†ëÏàòÏôÑÎ£å(is_accepted=True), ÌîΩÏóÖÏôÑÎ£å(is_active=False) -->
                        <th>Ï£ºÎ¨∏ ÏùºÏãú</th>
                        <th>Î¶¨Î∑∞ ÏûëÏÑ±</th>
                    </tr>
                    {% for order in orders %}
                    <tr>
                        <!-- ÏàúÏÑúÎåÄÎ°ú Ï£ºÎ¨∏Î≤àÌò∏, ÏºÄÏù¥ÌÅ¨ÏÇ¨ÏßÑ, Í∞ÄÍ≤åÏù¥Î¶Ñ, ÏßÑÌñâÏÉÅÌÉú, Ï£ºÎ¨∏ÏùºÏãú, Î¶¨Î∑∞ÏûëÏÑ± -->
                        <td>{{order.pk}}</td>

                        <!-- Ïù¥ÎØ∏ÏßÄÎ•º ÎàÑÎ•¥Î©¥ Ï£ºÎ¨∏ ÏÉÅÏÑ∏Î°ú Ïù¥ÎèôÌï®. -->
                        <td><a href="{% url 'order_detail' order_pk=order.pk %}"><img src="{{order.referred_cake.cake_image.url}}" aria-label="Ï£ºÎ¨∏Ìïú ÏºÄÏù¥ÌÅ¨"></a></td>
                        
                        <td>{{order.referred_store}}</td>

                        {% if order.is_paid %}
                        <td>Í≤∞Ï†úÏôÑÎ£å</td>
                        {% else %}
                        <td>Í≤∞Ï†úÎØ∏ÏôÑÎ£å</td>
                        {% endif %}
                        
                        <td>{{ order.order }}{{order.pub_date}}</td>
                        
                        {% if not order.review %}
                            {% if order.is_paid  %}
                            <td><a href="{% url 'review_page' pk=order.referred_cake_id orderpk=order.id %}">Î¶¨Î∑∞ ÏûëÏÑ±</a></td>
                            {% endif %}
                        {% else %}
                        <td><a href="{% url 'review_edit' pk=order.review.pk %}">Î¶¨Î∑∞ ÏàòÏ†ï</a><br>
                            <a href="{% url 'review_delete' pk=order.review.pk %}">Î¶¨Î∑∞ ÏÇ≠Ï†ú</a></td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </table>
                <div class="user-order-text">
                    <div class="info-more"><a href="{% url 'order_all' user_pk=user.pk %}"><button>ÎçîÎ≥¥Í∏∞</button></a></div>
                    <!-- Ï£ºÎ¨∏ ÎÇ¥Ïó≠ Ï†ÑÏ≤¥ ÌéòÏù¥ÏßÄ Íµ¨ÌòÑ ÌïÑÏöî -->
                </div>
                <br><br>
                
            </div>
        </div>
        <div class="user-review">
            <h2 id="review-info-header"> Î¶¨Î∑∞ Í¥ÄÎ¶¨ </h2>
            <div class="review-box">
                <div class="review-info" >
                    <!-- Î¶¨Î∑∞ ÏÉÅÏÑ∏Î≥¥Í∏∞, ÏàòÏ†ï, ÏÇ≠Ï†ú Íµ¨ÌòÑ ÏïÑÏßÅ X -->
                    <!-- ÏºÄÏûåÏù¥ÎØ∏ÏßÄ, ÏºÄÏù¥ÌÅ¨Ïù¥Î¶Ñ, Í∞ÄÍ≤åÏù¥Î¶Ñ, Î≥ÑÏ†ê, ÌèâÍ∞ÄÎÇ¥Ïö©(15Ïûê ÍπåÏßÄ) -->
                    <!-- Ïù¥ÎØ∏ÏßÄÏóê Î¶¨Î∑∞ ÏûêÏÑ∏ÌûàÎ≥¥Í∏∞ ÎßÅÌÅ¨ Îã¨ÏïÑÏïº Ìï®. -->
                    {% for review in reviews %}
                    <div class="review-card">
                        <a href="{% url 'review_detail' review_pk=review.pk %}"><img src="{% if review.review_img %}{{ review.review_img.url }} {% else %} {% static 'img/allcakes_bluecake.png' %} {% endif %}" aria-label="Ï£ºÎ¨∏Ìïú ÏºÄÏù¥ÌÅ¨"></a>
                        <br>
                        <span>Cake: {{review.order.referred_cake}}</span>
                        <br>
                        <span>Store: {{review.order.referred_store}}</span>
                        <br>
                        <section>{{review.comment|slice:"15"}}</section>
                        <div class="stars">
                            <span class="fa fa-star fa-2x checked"></span>
                            <span class="fa fa-star fa-2x {% if review.rate > 1 %} checked {% endif %}"></span>
                            <span class="fa fa-star fa-2x {% if review.rate > 2 %} checked {% endif %}"></span>
                            <span class="fa fa-star fa-2x {% if review.rate > 3 %} checked {% endif %}"></span>
                            <span class="fa fa-star fa-2x {% if review.rate > 4 %} checked {% endif %}"></span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="user-review-text">
                    <a href="{% url 'review_all' user_pk=user.pk %}"><button>ÎçîÎ≥¥Í∏∞</button></a> 
                </div>
            </div>
        </div>
        <div class="user-liked">
            <!-- ÏºÄÏù¥ÌÅ¨ -->
            <div class="liked-cakes">
                <h2 id="cake-info-header">Ï∞úÌïú ÏºÄÏù¥ÌÅ¨</h2>
                <hr style="height: 4px;">
                <div class="likedcake-box">
                    <div class="liked-contents">
                        <!-- ÏàúÏÑúÎåÄÎ°ú ÏºÄÏù¥ÌÅ¨ Ïù¥ÎØ∏ÏßÄ, ÏºÄÏù¥ÌÅ¨Ïù¥Î¶Ñ, Í∞ÄÍ≤åÏù¥Î¶Ñ, Î≥∏Î¨∏ -->
                        {% for cake in liked_cakes %}
                        <div class="likedcake-card">
                            <a href="{% url 'cake_detail' pk=cake.pk %}"><img src="{{cake.cake_image.url}}" aria-label="ÏºÄÏù¥ÌÅ¨ Ïù¥ÎØ∏ÏßÄ"></a>
                            <a href="{% url 'likedcake_delete' user_pk=user.pk cake_pk=cake.pk %}" class="delete-icon"><i class="fas fa-times"></i></a>
                            <br>
                            <span>{{cake.cakename}}</span>
                            <br>
                            <span>store: {{cake.referred_store}}</span>
                            <br>
                            <span>{{cake.referred_store.locationSi}}{{cake.referred_store.locationGu}}</span>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="user-liked-text">
                        <a href="{% url 'likedcakes_all' user_pk=user.pk %}"><button>ÎçîÎ≥¥Í∏∞</button></a> 
                    </div>
                    <!-- ÎÇ¥ Ï∞úÌïú Ï†ÑÏ≤¥ Î¶¨Ïä§Ìä∏ ÎçîÎ≥¥Í∏∞ Íµ¨ÌòÑ ÌïÑÏöî -->
                </div>
            </div>
            <br>
            <!-- Í∞ÄÍ≤å -->
            <div class="liked-stores">
                <h2 id="store-info-header">Ï∞úÌïú Í∞ÄÍ≤å</h2>
                <hr style="height: 5px;">
                <div class="likedstore-box">
                    <div class="liked-contents">
                        <!-- ÏàúÏÑúÎåÄÎ°ú Í∞ÄÍ≤åÏù¥Î¶Ñ, Ïù¥ÎØ∏ÏßÄ, Ïû•ÏÜå, Î≥∏Î¨∏ -->
                        {% for store in liked_stores %}
                        <div class="likedstore-card">
                            <a href="{% url 'store_detail' pk=store.pk %}"><img src="{{store.store_image.url}}" aria-label="Í∞ÄÍ≤å Ïù¥ÎØ∏ÏßÄ"></a>
                            <a href="{% url 'likedstore_delete' user_pk=user.pk store_pk=store.pk %}" class="delete-icon"><i class="fas fa-times"></i></a>
                            <br>
                            <span>{{store.name}}</span>
                            <br>
                            <span>{{store.locationSi}}{{store.locationGu}}</span>
                            <section>{{store.text|slice:"15"}}</section>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="user-liked-text">
                        <a href="{% url 'likedstores_all' user_pk=user.pk %}"><button>ÎçîÎ≥¥Í∏∞</button></a> 
                    </div>
                    <!-- ÎÇ¥ Ï∞úÌïú Ï†ÑÏ≤¥ Î¶¨Ïä§Ìä∏ ÎçîÎ≥¥Í∏∞ Íµ¨ÌòÑ ÌïÑÏöî -->
                </div>
            </div>
        </div>
    </div>
{% endif %}
</body>
</html>
